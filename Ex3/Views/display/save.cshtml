
@{
    ViewBag.Title = "save";
}
<head>
    

    <style>
        body {
            margin: 0px;
        }
        h2 {
            font-size: 50px;
            color: black;
            font-family: 'Gill Sans';
            text-align: center;
            padding: unset;
            Margin: unset;
        }
        div{
            margin: 0px;
        }

        .center {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
    </style>

</head>
<body background="~/Content/Images/export-map-share.png" style="background-size:100% 100%; background-attachment:fixed; width:100%; height:100%; overflow: hidden;">
    <div id="divCanva2">
        <canvas id="canvas2" style="position:absolute"></canvas>
    </div>
    <div id="divCanva">
        <canvas id="canvas" style="position:absolute"></canvas>
    </div>
    <div id="divText">
        <h2 id="mytxt"> Saving...</h2>
    </div>
    <script src="~/Scripts/jquery-1.10.2.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/drawLine.js"></script>
    <script src="~/Scripts/xmlRead.js"></script>
    <script src="~/Scripts/realDraw.js"></script>
    <script src="~/Scripts/drawPoint.js"></script>


    <script>
        canvas2.setAttribute('width', window.innerWidth)
        canvas2.setAttribute('height', window.innerHeight)
        canvas.setAttribute('width', window.innerWidth)
        canvas.setAttribute('height', window.innerHeight)
        var old_lon;
        var old_lat;
        var c = document.getElementById("canvas").getContext("2d");
        var c2 = document.getElementById("canvas2").getContext("2d");

        drawPoint(@ViewBag.lon,@ViewBag.lat);

        myTimer = (function () {
            $.post("@Url.Action("SaveLocation")").done(drawLine);
        });

         myTimerEnd = (function () {
           $.post("@Url.Action("GetLocation")").done(function (xml) {
               xmlRead(xml);
               realDraw(c2, "black");
        });
        });

        EndTime=@ViewBag.duration * 1000;
        IntervalTime =@ViewBag.time * 1000;
        stop = (function () {
            clearInterval(interval)
            document.getElementById("mytxt").innerHTML = "Done";
            $.post("@Url.Action("EndSave")");
            setInterval(myTimerEnd, IntervalTime);
            myTimerEnd();

        });
        setTimeout(stop, EndTime);
        var interval = setInterval(myTimer, IntervalTime);
        myTimer();

    </script>
</body>
